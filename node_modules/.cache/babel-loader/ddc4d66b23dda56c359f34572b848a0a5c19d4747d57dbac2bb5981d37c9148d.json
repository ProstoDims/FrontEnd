{"ast":null,"code":"import _slicedToArray from\"E:/Downloads/\\u0414\\u0437/Project-master/MarkingSystem/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import ClassSelect from\"./mini_components/ClassSelect\";import SubjectSelect from\"./mini_components/SubjectSelect\";import MarkTable from\"./mini_components/MarksTable\";import axios from\"axios\";import Header from\"../Header/Header\";import Footer from\"../Footer/Footer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Marks=function Marks(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),school_class=_useState2[0],setSchool_Class=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),subject=_useState4[0],setSubject=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),visibleSubjects=_useState6[0],setVisibleSubjects=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),visibleTable=_useState8[0],setVisibleTabel=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var getAll=function getAll(){if(school_class>0){axios.get(\"http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/students/\".concat(school_class,\"/\"),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('ACCESS'))}}).then(function(responce){setData(responce.data);}).catch(function(error){if(localStorage.getItem('REFRESH')&&error.response.status===401){axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/',{refresh:localStorage.getItem('REFRESH')}).then(function(responce){localStorage.setItem('ACCESS',responce.data.access);getAll();});}});}};var changeMark=function changeMark(newMark){axios.put(\"http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/marks/\".concat(newMark.id,\"/\"),newMark,{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('ACCESS'))}}).then(function(responce){getAll();}).catch(function(error){if(localStorage.getItem('REFRESH')&&error.response.status===401){axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/',{refresh:localStorage.getItem('REFRESH')}).then(function(responce){localStorage.setItem('ACCESS',responce.data.access);changeMark(newMark);});}});};var addNew=function addNew(student){axios.post(\"http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/marks/\".concat(student.id,\"/create\"),student,{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('ACCESS'))}}).then(function(responce){getAll();}).catch(function(error){if(localStorage.getItem('REFRESH')&&error.response.status===401){axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/',{refresh:localStorage.getItem('REFRESH')}).then(function(responce){localStorage.setItem('ACCESS',responce.data.access);addNew(student);});}});};var changeClass=function changeClass(value){if(value>0){setSchool_Class(value);setVisibleSubjects(true);}else{setVisibleSubjects(false);setVisibleTabel(false);}};var changeSubject=function changeSubject(value){if(value){setSubject(value);setVisibleTabel(true);}else{setVisibleTabel(false);}};useEffect(function(){getAll();},[school_class]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(ClassSelect,{changeClass:changeClass}),visibleSubjects?/*#__PURE__*/_jsx(SubjectSelect,{changeSubject:changeSubject}):/*#__PURE__*/_jsx(\"p\",{}),visibleSubjects&&visibleTable?/*#__PURE__*/_jsx(MarkTable,{students:data,subject:subject,change:changeMark,addNew:addNew}):/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(Footer,{})]});};export default Marks;","map":{"version":3,"names":["useEffect","useState","ClassSelect","SubjectSelect","MarkTable","axios","Header","Footer","jsx","_jsx","jsxs","_jsxs","Marks","_useState","_useState2","_slicedToArray","school_class","setSchool_Class","_useState3","_useState4","subject","setSubject","_useState5","_useState6","visibleSubjects","setVisibleSubjects","_useState7","_useState8","visibleTable","setVisibleTabel","_useState9","_useState10","data","setData","getAll","get","concat","headers","Authorization","localStorage","getItem","then","responce","catch","error","response","status","post","refresh","setItem","access","changeMark","newMark","put","id","addNew","student","changeClass","value","changeSubject","children","students","change"],"sources":["E:/Downloads/ะะท/Project-master/MarkingSystem/frontend/src/components/Marks/marks.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport ClassSelect from \"./mini_components/ClassSelect\"\r\nimport SubjectSelect from \"./mini_components/SubjectSelect\"\r\nimport MarkTable from \"./mini_components/MarksTable\"\r\nimport axios from \"axios\"\r\nimport Header from \"../Header/Header\"\r\nimport Footer from \"../Footer/Footer\"\r\n\r\n\r\nconst Marks = () =>\r\n{\r\n    const [school_class, setSchool_Class] = useState('')\r\n    const [subject, setSubject] = useState('')\r\n    const [visibleSubjects, setVisibleSubjects] = useState(false)\r\n    const [visibleTable, setVisibleTabel] = useState(false)\r\n    const [data, setData] = useState([])\r\n\r\n    const getAll = () =>\r\n    {\r\n        if(school_class > 0)\r\n        {\r\n            axios.get(`http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/students/${school_class}/`,\r\n            {headers: {Authorization: `Bearer ${localStorage.getItem('ACCESS')}`}})\r\n            .then(responce => {\r\n                setData(responce.data)\r\n            })\r\n            .catch(error=>\r\n            {\r\n                if(localStorage.getItem('REFRESH') && error.response.status === 401)\r\n                {\r\n                    axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/', {refresh: localStorage.getItem('REFRESH')})\r\n                    .then(responce => {\r\n                        localStorage.setItem('ACCESS', responce.data.access)\r\n                        getAll()\r\n                    })\r\n                }\r\n            })\r\n        }\r\n       \r\n    }\r\n\r\n    const changeMark = (newMark) =>\r\n    {     \r\n        axios.put(`http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/marks/${newMark.id}/`, newMark,\r\n        {headers: {Authorization: `Bearer ${localStorage.getItem('ACCESS')}`}})\r\n        .then(responce => \r\n        {\r\n           getAll()\r\n        })\r\n        .catch(error=>\r\n        {\r\n            if(localStorage.getItem('REFRESH') && error.response.status === 401)\r\n            {\r\n                axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/', {refresh: localStorage.getItem('REFRESH')})\r\n                .then(responce => {\r\n                    localStorage.setItem('ACCESS', responce.data.access)\r\n                    changeMark(newMark)\r\n                })\r\n            }\r\n        })\r\n    }\r\n    const addNew = (student) =>\r\n    {\r\n        axios.post(`http://maximzhak43.pythonanywhere.com/eduschedule/api/v1/marks/${student.id}/create`, student,\r\n        {headers: {Authorization: `Bearer ${localStorage.getItem('ACCESS')}`}})\r\n        .then(responce => \r\n        {\r\n           getAll()\r\n        })\r\n        .catch(error=>\r\n        {\r\n            if(localStorage.getItem('REFRESH') && error.response.status === 401)\r\n            {\r\n                axios.post('http://maximzhak43.pythonanywhere.com/token/refresh/', {refresh: localStorage.getItem('REFRESH')})\r\n                .then(responce => {\r\n                    localStorage.setItem('ACCESS', responce.data.access)\r\n                    addNew(student)\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    const changeClass = (value) =>\r\n    {  \r\n        if(value > 0)\r\n        {\r\n            setSchool_Class(value)\r\n            setVisibleSubjects(true)\r\n        }\r\n        else\r\n        {\r\n            setVisibleSubjects(false)\r\n            setVisibleTabel(false)\r\n        }\r\n    }\r\n    \r\n    const changeSubject = (value) =>\r\n    {\r\n        if(value)\r\n        {\r\n            setSubject(value)\r\n            setVisibleTabel(true)\r\n        }\r\n        else\r\n        {   \r\n            setVisibleTabel(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() =>{\r\n        getAll()\r\n    }, [school_class])\r\n\r\n    return (\r\n        <div>\r\n            <Header />\r\n            <ClassSelect changeClass={changeClass}/>\r\n            {visibleSubjects\r\n            ? <SubjectSelect changeSubject={changeSubject}/>\r\n            : <p></p>\r\n            }\r\n            {visibleSubjects && visibleTable\r\n            ? <MarkTable students={data} subject={subject} change={changeMark} addNew={addNew}/>\r\n            : <p/>\r\n            }\r\n            <Footer />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Marks;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}